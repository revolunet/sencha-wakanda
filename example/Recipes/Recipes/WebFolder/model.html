<!DOCTYPE html>
<html>
    <head>
        <title>sencha</title>
        <!-- <meta name="WAF.config.loadCSS" id="waf-interface-css" content="styles/index.css"/>
        <meta name="WAF.config.loadCSS" id="waf-palette" content="/walib/WAF/widget/palette/css/widget-palette-blue.css"/> -->
        <link rel="stylesheet" href="scripts/ext/resources/css/ext-all-gray.css" type="text/css" media="screen" charset="utf-8">
        <link rel="stylesheet" href="styles/style.css" type="text/css" media="screen" charset="utf-8">
    </head>
    <body>
        <!-- <script type="text/javascript" src="/waLib/WAF/Loader.js"></script> -->
        <script type="text/javascript" src="scripts/ext/ext-all-debug.js"></script>

        <script type="text/javascript" src="https://raw.github.com/revolunet/sencha-wakanda/master/extjs/4.0.2a/Ext.data.writer.Wakanda.js"></script>
        <script type="text/javascript" src="https://raw.github.com/revolunet/sencha-wakanda/master/extjs/4.0.2a/Ext.data.reader.Wakanda.js"></script>
        <script type="text/javascript" src="https://raw.github.com/revolunet/sencha-wakanda/master/extjs/4.0.2a/Ext.data.proxy.Wakanda.js"></script>
        <script type="text/javascript" src="https://raw.github.com/revolunet/sencha-wakanda/master/extjs/4.0.2a/Ext.data.WakandaModel.js"></script>

        <!-- <script type="text/javascript" src="scripts/src.js"></script> -->

        <script type="text/javascript">

            Ext.define('Employee', {
                extend: 'Ext.data.WakandaModel'
            });

            Ext.onReady(function() {

                var Employee = Ext.ModelManager.getModel('Employee');

                // load employee (id: 891464)
                Employee.load(891464, {
                    success: function(employee) {
                        console.log('employee ' + employee.getId() + ' loaded: ', 'salary = ' + employee.get('salary'));

                        // set employee salary
                        employee.set('salary', Math.floor(Math.random() * 100000));

                        // sync employee
                        employee.save({
                            success: function(employee) {
                                console.log('employee ' + employee.getId() + ' updated: ', 'salary = ' + employee.get('salary'));
                            }
                        });

                    }
                });

                // create employee
                var employee = Ext.create('Employee', {
                    firstName: 'John',
                    lastName: 'Smith',
                    salary: Math.floor(Math.random() * 100000)
                });
                
                // sync employee
                employee.save({
                    success: function() {
                        console.log('employee ' + employee.getId() + ' created: ', 'salary = ' + employee.get('salary'));

                        var id = employee.getId();

                        // destroy employee
                        employee.destroy({
                            success: function() {
                                console.log('employee ' + id + ' has been destroyed!');
                            }
                        });
                    }
                });

            });

        </script>

    </body>
</html>
